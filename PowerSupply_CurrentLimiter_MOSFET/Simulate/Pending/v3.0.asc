Version 4.1
SHEET 1 1096 1444
WIRE -64 128 -64 96
WIRE 96 128 96 96
WIRE 256 240 256 176
WIRE -64 256 -64 208
WIRE 96 256 96 208
WIRE 608 256 608 160
WIRE 608 352 608 336
WIRE 704 352 608 352
WIRE -304 368 -304 336
WIRE -176 368 -304 368
WIRE 0 368 -96 368
WIRE 256 368 256 320
WIRE 256 368 192 368
WIRE 608 368 608 352
WIRE 608 384 608 368
WIRE -304 400 -304 368
WIRE 704 400 704 352
WIRE 0 464 -48 464
WIRE 256 464 192 464
WIRE 496 464 256 464
WIRE 560 464 496 464
WIRE 496 480 496 464
WIRE 608 496 608 480
WIRE -48 512 -48 464
WIRE -304 528 -304 480
WIRE 608 528 608 496
WIRE 704 528 704 464
WIRE 704 528 608 528
WIRE 496 608 496 560
WIRE 256 640 256 464
WIRE 384 688 320 688
WIRE 608 688 608 528
WIRE 608 688 560 688
WIRE 608 720 608 688
WIRE 256 848 256 736
WIRE 608 848 608 800
WIRE 608 848 256 848
WIRE 48 896 -304 896
WIRE 384 896 384 688
WIRE 384 896 128 896
WIRE 608 912 608 848
WIRE 320 1040 320 992
WIRE -96 1056 -96 1008
WIRE 560 1056 560 688
WIRE 560 1056 352 1056
WIRE 192 1072 -64 1072
WIRE 288 1072 192 1072
WIRE -304 1088 -304 896
WIRE -128 1088 -304 1088
WIRE 416 1088 352 1088
WIRE -16 1104 -64 1104
WIRE -16 1136 -16 1104
WIRE 320 1168 320 1104
WIRE -96 1184 -96 1120
WIRE -16 1248 -16 1216
WIRE 192 1280 192 1072
WIRE 288 1280 192 1280
WIRE 416 1280 416 1088
WIRE 416 1280 368 1280
WIRE 416 1312 416 1280
WIRE 416 1424 416 1392
FLAG 96 256 0
FLAG 608 912 0
FLAG 496 608 0
FLAG 96 96 VDD
FLAG 608 160 VDD
FLAG -48 512 0
FLAG -304 528 0
FLAG -304 336 IN
FLAG 256 176 VDD
FLAG 608 496 S
FLAG 608 368 D
FLAG -64 256 0
FLAG -64 96 VEE
FLAG 320 992 VDD
FLAG 320 1168 VEE
FLAG 416 1424 0
FLAG -96 1008 VDD
FLAG -96 1184 VEE
FLAG -16 1248 0
SYMBOL voltage 96 112 R0
WINDOW 0 36 37 Left 2
WINDOW 3 37 65 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 12
SYMBOL res 240 224 R0
SYMATTR InstName R1
SYMATTR Value 47
SYMBOL npn 320 640 M0
WINDOW 0 87 29 Left 2
WINDOW 3 88 62 Left 2
SYMATTR InstName Q2
SYMATTR Value BC337-40
SYMBOL res 592 704 R0
WINDOW 0 42 34 Left 2
WINDOW 3 46 59 Left 2
SYMATTR InstName R2
SYMATTR Value 0.025
SYMBOL res 592 240 R0
SYMATTR InstName LOAD
SYMATTR Value 2
SYMBOL nmos 560 384 R0
WINDOW 3 56 72 Invisible 2
SYMATTR Value PSMN1R025YLD
SYMATTR InstName M1
SYMBOL res 480 464 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL Optos\\PC817A 96 416 R0
SYMATTR InstName U1
SYMBOL res -192 384 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value 330
SYMBOL voltage -304 384 R0
WINDOW 0 41 37 Left 2
WINDOW 3 -45 -10 Invisible 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(0 3.3 0 {0.01/Fs} {0.01/Fs} {0.5/Fs} {1/Fs})
SYMBOL voltage -64 224 R180
WINDOW 0 -65 71 Left 2
WINDOW 3 -65 44 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 0.2
SYMBOL MyLib\\OpAmp\\LM358 320 1008 M0
SYMATTR InstName U2
SYMBOL res 384 1264 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 47k
SYMBOL res 400 1296 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL MyLib\\OpAmp\\LM358 -96 1024 M0
SYMATTR InstName U3
SYMBOL voltage -16 1120 R0
WINDOW 0 37 40 Left 2
WINDOW 3 42 67 Left 2
SYMATTR InstName V4
SYMATTR Value 2.4
SYMBOL res 144 880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 2.2k
SYMBOL cap 448 224 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL schottky 720 464 R180
WINDOW 0 -46 35 Left 2
WINDOW 3 -123 10 Left 2
SYMATTR InstName D2
SYMATTR Value MBRS340
TEXT -296 592 Left 2 !.tran {3/Fs}
TEXT 640 808 Left 2 ;R2 = (Zeneer Voltage + 0.7v) / Curent\nR2 = (7.5 + 0.7v) / 2A\nR2 = 4.1
TEXT -280 488 Left 2 !.param Fs=1kHz
